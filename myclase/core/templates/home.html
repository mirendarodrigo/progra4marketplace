{% extends "base.html" %}
{% load static %}
{% load socialaccount %}
{% block title %}Mercadito · Tu marketplace simple{% endblock %}

{% block content %}
<div class="container py-5">
  <div class="d-flex flex-column flex-lg-row align-items-stretch gap-5">

    <!-- Carrusel izquierdo -->
    <div class="flex-fill" style="max-width: 55%;">
      <div id="infoCarousel" class="carousel slide h-100" data-bs-ride="carousel">
        <div class="carousel-inner h-100">

          <!-- Slide 1 -->
          <div class="carousel-item active h-100 position-relative">
            <img src="{% static 'img/facilidad.png' %}" class="d-block w-100 h-100 object-fit-cover" alt="Fácil de usar">
            <div class="carousel-caption d-flex flex-column justify-content-center align-items-center h-100">
              <h3 class="fw-semibold bg-dark bg-opacity-50 px-3 py-2 rounded">Fácil de usar</h3>
              <p class="bg-dark bg-opacity-50 px-3 py-2 rounded">Publicá productos en minutos y encontrá lo que buscás rápidamente.</p>
            </div>
          </div>

          <!-- Slide 2 -->
          <div class="carousel-item h-100 position-relative">
            <img src="{% static 'img/seguridad.png' %}" class="d-block w-100 h-100 object-fit-cover" alt="Confiable">
            <div class="carousel-caption d-flex flex-column justify-content-center align-items-center h-100">
              <h3 class="fw-semibold bg-dark bg-opacity-50 px-3 py-2 rounded">Confiable</h3>
              <p class="bg-dark bg-opacity-50 px-3 py-2 rounded">Autenticación segura con Google o GitHub.</p>
            </div>
          </div>

          <!-- Slide 3 -->
          <div class="carousel-item h-100 position-relative">
            <img src="{% static 'img/gratis.png' %}" class="d-block w-100 h-100 object-fit-cover" alt="100% gratuito">
            <div class="carousel-caption d-flex flex-column justify-content-center align-items-center h-100">
              <h3 class="fw-semibold bg-dark bg-opacity-50 px-3 py-2 rounded">100% gratuito</h3>
              <p class="bg-dark bg-opacity-50 px-3 py-2 rounded">Sin costos ocultos, solo conecta y comercia.</p>
            </div>
          </div>

        </div>

        <!-- Controles -->
        <button class="carousel-control-prev custom-carousel-btn" data-bs-target="#infoCarousel" data-bs-slide="prev">
          <span class="carousel-control-prev-icon"></span>
        </button>
        <button class="carousel-control-next custom-carousel-btn" data-bs-target="#infoCarousel" data-bs-slide="next">
          <span class="carousel-control-next-icon"></span>
        </button>
      </div>
    </div>

    <!-- Panel derecho: login / acciones -->
    <div class="flex-fill d-flex justify-content-center" style="max-width: 45%;">
      <div class="p-4 border rounded shadow-sm bg-light h-100 d-flex flex-column justify-content-center align-items-center text-center">
        {% if not user.is_authenticated %}
          <h2 class="fw-bold text-dark mb-3">Bienvenido a <span class="text-primary">Mercadito</span></h2>
          <p class="fs-5 text-dark mb-4">Ingresá para comenzar a publicar o comprar.</p>
          <div class="d-flex flex-column gap-2 w-100">
            <a class="btn btn-light shadow-sm d-flex align-items-center justify-content-center" href="{% provider_login_url 'google' %}">
              <img width="24" height="24" class="me-2" src="https://img.icons8.com/color/48/google-logo.png" alt="Google"/>
              Ingresar con Google
            </a>
            <a class="btn btn-dark shadow-sm d-flex align-items-center justify-content-center" href="{% provider_login_url 'github' %}">
              <img width="24" height="24" class="me-2" src="https://img.icons8.com/glyph-neue/48/github.png" alt="GitHub"/>
              Ingresar con GitHub
            </a>
          </div>
        {% else %}
          <h2 class="fw-bold text-dark mb-3">¡Hola, {{ user.first_name }}!</h2>
          <a class="btn btn-primary btn-lg mb-2" href="{% url 'product_list' %}">Explorar productos</a>
          <a class="btn btn-outline-secondary btn-lg ms-2" href="{% url 'add_product' %}">Publicar un producto</a>
        {% endif %}
      </div>
    </div>

  </div>
</div>

<style>
/* Quitar borde y resaltar en botones del carousel */
.custom-carousel-btn:focus,
.custom-carousel-btn:active {
  outline: none;
  box-shadow: none;
  border: none;
}

/* Tamaño de iconos */
.carousel-control-prev-icon,
.carousel-control-next-icon {
  width: 3rem;
  height: 3rem;
}

/* Carrusel: imagen consistente y tamaño fijo para evitar saltos */
.object-fit-cover {
  object-fit: cover;
}

/* Asegurar que el carrusel ocupe todo el alto del contenedor */
#infoCarousel, 
#infoCarousel .carousel-inner, 
#infoCarousel .carousel-item,
#infoCarousel img {
  height: 100%;
}

/* Ajustar caption para ocupar todo el alto */
.carousel-caption {
  top: 0;
  bottom: 0;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
}
</style>
{% endblock %}
